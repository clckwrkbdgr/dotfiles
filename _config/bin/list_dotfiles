#!/usr/bin/python3
import os, os.path, re

HOMEDIR_DOTFILES = """.bashrc
.profile
.config
.cache
.local
.private
.haven
""".splitlines()

HOMEDIR = os.path.expanduser("~")

TODO_DOTFILES = []
with open(os.path.join(HOMEDIR, ".config/bin/xdg"), "r") as f:
	for line in f:
		if 'TODO' in line:
			try:
				TODO_DOTFILES.append(line.split('TODO')[1].split(maxsplit=1)[0])
			except IndexError:
				pass

GIT_DOTFILES = """.gitignore
.gitattributes
.gitconfig
.gitmodules
""".splitlines()

unknown_files = 0
is_git = False
for filename in sorted(os.listdir(".")):
	if not filename.startswith("."):
		continue
	if os.getcwd() == HOMEDIR:
		if filename in HOMEDIR_DOTFILES or filename in TODO_DOTFILES:
			continue
	if filename == '.git':
		print("[git]", end='')
		is_git = True
		continue
	if is_git and filename in GIT_DOTFILES:
		continue
	unknown_files += 1

if unknown_files:
	print("[.{0}]".format(unknown_files))
