#!/bin/bash

voice() {
	IFS='\n'
	while read line; do
		echo '(voice_us1_mbrola)'
		# Following setting is not working as command for some reason.
		# Should be set globally in /usr/share/festival/festival.scm
		echo '(set! default_after_synth_hooks (list (lambda (utt) (utt.wave.rescale utt 1.5 t))))'
		echo '(SayText "'"$line"'")'
	done | festival --pipe
}

if [ -z "$1" ]; then
	echo 'Oh.'
elif [ "$1" == "-" ]; then
	cat
else
	echo "$@"
fi | voice
